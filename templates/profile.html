{% extends "base.html" %}

{% block content %}
  <h1>My Profile</h1>

  <p><strong>Email:</strong> {{ email }}</p>

  {% if subscription %}
    <p><strong>Subscription Plan:</strong> {{ subscription.plan }}</p>
    <p>
      <strong>Status:</strong>
      <span class="status-{{ subscription.status | lower }}">
        {{ subscription.status | capitalize }}
      </span>
    </p>

    {% if subscription.status in ['active', 'trialing'] %}
      <p>
        <strong>Next Billing Date:</strong>
        {{ subscription.renewal | datetimeformat }}
      </p>
    {% elif subscription.status == 'canceled' and subscription.renewal %}
      <p>
        <strong>Subscription valid until:</strong>
        {{ subscription.renewal | datetimeformat }}
      </p>
    {% elif subscription.status == 'past_due' %}
      <p><strong>Attention:</strong> Your payment is past due. Please update your method.</p>
    {% elif subscription.status == 'unpaid' %}
      <p><strong>Notice:</strong> Your subscription is unpaid and inactive.</p>
    {% endif %}

    <p>
      <a href="/manage-subscription" class="btn btn-info">
        Manage Billing &amp; Subscription
      </a>
    </p>
  {% else %}
    <p><em>You don‚Äôt have an active subscription.</em></p>
    <p>
      <a href="{{ request.url_for('subscribe_page') }}" class="btn btn-primary">
        Subscribe Now
      </a>
    </p>
  {% endif %}

  <hr>

  <p>
    <a href="{{ request.url_for('change_password_form') }}">
      üîê Change Password
    </a>
  </p>

  <style>
    .status-active   { color: green;   font-weight: bold; }
    .status-trialing { color: blue;    font-weight: bold; }
    .status-canceled { color: orange;  font-weight: bold; }
    .status-past_due { color: red;     font-weight: bold; }
    .status-unpaid   { color: darkred; font-weight: bold; }

    .btn {
      display: inline-block;
      padding: 0.5em 1em;
      border-radius: 4px;
      text-decoration: none;
      font-weight: 500;
    }
    .btn-primary { background-color: #007bff; color: white; }
    .btn-info    { background-color: #17a2b8; color: white; }
  </style>
{% endblock %}
